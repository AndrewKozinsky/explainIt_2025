# New Component: Video and subtitles

## Purpose
Компонент плеера с видео с субтитрами для русскоязычных пользователей изучающих английский. Реализовать с нуля, не затрагивая существующие страницы. Мне нужно создать компонент в который пользователь будет перетаскивать видео на английском языке и писать субтитры. И затем проигрывать видео смотря на эти субтитры.

Используй компонент VideoRoot. Компонент будет состоять из 2 частей: сверху видео и снизу субтитры.

## Video part
### Loading and Display
При монтировании компонента программа проверят, есть ли данные о ранее загруженном видео. Они могут храниться в LocalStorage или IndexedDB. Если есть, то показать видео. Если нет, то показать поле для перетаскивания видео.

Видео хранится на компьютере пользователя локально и не загружается на сервер.

Если пользователь работает с сайтом на компьютере, то перетаскивает видео в область компонента для загрузки. В середине области загрузки есть заголовок «Перетащите видео сюда». И ниже более мелкий текст: «Поддерживаются MP4, WebM, OGG, MKV». Ещё ниже кнопка «Где взять и как перевести в нужный формат». Она пока никак не функционирует, но в будущем будет вести к инструкции по конвертации видео.

Если смотрит на сенсорном устройстве, то поставь заголовок «Выберите видео» потому что тач-интерфейс не поддерживает drag-and-drop. Поэтому поставь кнопку указывающую на файловый выбор. И тоже кнопку «Где взять и как перевести в нужный формат».

Если пользователь перетащил или выбрал файл в неправильном формате, показать уведомление об ошибке с текстом «Неподходящий тип файла». Сообщение об ошибке должно стоять после заголовка.

После загрузки видео отображается в плеере.

### Playback Controls

Остановить или запустить воспроизведение видео можно если нажать кнопкой или пальцем на любую часть проигрывателя либо использовать клавишу пробела.

Если провести мышью с зажатой клавишей по горизонтали (сделать жест перетаскивания) или провести пальцем по экрану, то видео будет перематываться. Если слева направо, то вперёд, если справа налево — назад. При этом чем выше начальная точка перетаскивания, тем с большой скоростью будет перемотка. Перемотать можно клавишами-стрелками «влево» и «вправо». В этом случае перемотка будет с шагом в 2 секунды. А если зажать Shift, то с шагом в 10 секунд.

При перемотке на видео будет накладываться полупрозрачный синий слой, который будет идти от левого края и занимать всё пространство до текущей позиции воспроизведения. По высоте слой должен занимать всё доступное пространство.

Снизу есть контейнер для полосы прогресса воспроизведения. По высоте занимает 10 пикселей. Сама видимая полоса высотой 5 пикселей синего цвета. Если пользователь наводит курсором на контейнер, то полоса занимает всю доступную высоту. И перематывает видео на указанную позицию.

При перемотке в центре экрана появляется время текущей позиции воспроизведения в формате 09:18 / 1:48:32. Текст белого цвета. Текущее время высотой 70 пикселей, общее время высотой 30 пикселей.

Если пользователь не перематывает видео в течение 1 секунды, то полупрозрачный слой и время исчезают.

### Volume Control

Если провести мышью с зажатой клавишей по вертикали, то будет изменена громкость. Если нажимать клавиши-стрелки «вверх» и «вниз», то громкость будет изменяться с шагом в 2 процента. При этом если зажать Shift, то шаг будет 10 процентов.

Текущий уровень громкости отображается в виде горизонтальной оранжевой полосы снизу проигрывателея. По ширине полоса занимает всё пространство проигрывателя. Высота зависит от уровня громкости. На максимальной громкости занимает всю высоту.

При изменении уровня громкости в центре проигрывателя показывается текст с текущим значением громкости в процентах. Текст белого цвета, высотой 70 пикселей.

Если пользователь не изменяет уровень звука в течение 1 секунды, то полупрозрачный слой и текст исчезают.

### Delete video button

Кнопка удаления видео появляется при наведении мышью на окно проигрывателя. Придумать и реализовать как эта кнопка появится на сенсорном устройстве. При нажатии убирает видео из проигрывателя.

### Subtitles on the player

Если субтитры ещё не указаны, то ничего не показывать.

Субтитры должны отображаться внизу проигрывателя, поверх видео в виде длинной строки и идти друг за другом. Так как между диалогами персонажей может быть пауза (персонажи не говорят), то на этом месте показать круг. Таким образом блоки с диалогами идут последовательно, разделяясь паузами если они есть.

Так как диалогов может быть очень много, то сделать механизм чтобы уже пройденные диалоги удалялись из обёртки по мере прокрутки, а новые добавлялись по мере воспроизведения. 

Сделать возможность перетаскивать строку субтитров мышью или пальцем чтобы посмотреть предыдущий или следующий текст.

При воспроизведении строка субтитров должна автоматически прокручиваться к текущему диалогу.

Можно нажать на блок субтитров или блок паузы и время должно перескочить к этому моменту.

Текст субтитров белого цвета, размер шрифта 22 пикселя, межстрочное расстояние 26 пикселей. Круг белого цвета с прозрачностью 0.1. Радиус круга 14 пикселей. Круг должен быть центрирован по горизонтали.

Контейнер субтитров должен иметь отступ снизу 10 пикселей, а по сторонам 20 пикселей. Фоновый цвет не ставить.

Текущий диалог имеет фоновый акцентный цвет, отступы по бокам 4 пикселя и закругленные углы. Радиус скругления 3 пикселей.

Если перешли к паузе, то круг в субтитрах становится полностью непрозрачным. Круг — это круговой/радиальный таймер (circular countdown timer), который показывает оставшееся время до следующего диалога. Как только время паузы истечёт, то он станет снова полупрозрачным.

## Subtitles part
### Subtitles input
При монтировании компонента программа проверят, есть ли данные о ранее загруженных субитрах. Они могут храниться в LocalStorage или IndexedDB. Если есть, то показать. Если нет, то показать поле для ввода субтитров. Используй компонент TextInput с указанием 5 строк. Добавь подпись «Субтитры в формате SRT».

К полю добавь подсказку по формату субтитров:
1
00:00:01,000 --> 00:00:04,000
Первая фраза субтитров

2
00:00:05,000 --> 00:00:08,000
Вторая фраза субтитров

Ниже поля ввода субтитров есть 2 кнопки: «Где взять субтитры» и «Сохранить». Кнопка «Где взять субтитры» слева, кнопка «Сохранить» справа. Левая кнопка ничего не делает. Пока просто поставь. Кнопка сохранения сохраняет субтитры в LocalStorage или IndexedDB. Если субтитры вввели в неправильном формате или ничего не ввели, то кнопка сохранения не активна. А сообщение об ошибки идёт от поля ввода.

Как только ввели субтитры в правильном формате кнопку сохранения становится активной.

После успешного сохранения субтитров вместо поля ввода появляется кнопка «Редактировать». Ниже список субтитров в виде абзацев. Каждый абзац должен иметь отступы по бокам 20 пикселей и отступ снизу 10 пикселей. Если между субтитрами есть паузы, то между абзацами проходит горизонтальная полоска толщиной 1 пиксель и акцентным цветом. С левой стороны находится круг диаметром 10 пикселей заполненный акцентным цветом.

Если текущая точка воспроизведения совпадает с моментом времени абзаца, то этот абзац должен иметь акцентный цвет. А слева от него должна быть вертикальная полоска шириной 3 пикселя заполненный акцентным цветом.

Если текущая точка воспроизведения совпадает с паузой между диалогами, то горизонтальная полоска должна иметь акцентрый цвет.

Каждый абзац субтитров должен быть кликабельным. При клике на абзац время воспроизведения должно перескочить к соответствующему моменту видео. Абзац должен иметь hover-эффект и курсор должен меняться на pointer.

Если навести на абзац, то цвет текста должен стать синим.

Если текущая точка воспроизведения находится в пределах абзаца, то требуется поставить в буфер обмена предложение, к которому принадлежит этот абзац. Если в абзаце несколько предложений, то поставить в буфер обмена все.

Например:
54
00:04:04,880 --> 00:04:07,451
At one with the soil.
Just getting covered in dirt.
Тут 2 предложения входят в абзац. Поэтому все 2 поставить в буфер обмена (At one with the soil. Just getting covered in dirt.).

Если же текущая точка воспроизведения на втором абзаце, но видно, что предложение не полное, то нужно вычислить, где заканчивается предложение и поставить в буфер обмена только то, что полностью входит в текущий абзац.
2
00:01:06,520 --> 00:01:08,340
Thousands of years ago,

3
00:01:08,440 --> 00:01:11,808
these were the forces
that ruled our world. But we can do nothing.
В этом случае в буфер обмена нужно поставить текст "Thousands of years ago, these were the forces that ruled our world."

Чтобы поделить субтитры на предложения можно использовать одну из библиотек NLP, например, wink-nlp или compromise.js. Пока я остановлюсь на английском языке, так как это упростит реализацию.